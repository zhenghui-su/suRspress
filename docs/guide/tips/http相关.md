# HTTP 相关

## 网络知识

### 方式

特点：整体性，基础理论 + 协议了解 + 业务的场景

### 举例

#### HTTP请求有哪些方式？分别用在哪些场景下？*

GET、POST、PUT、DELETE、OPTIONS

##### GET和POST的请求的区别？*

- 场景上：

  - GET 用于获取资源而不对服务资源做更改提交的请求 => 即幂等(即做几次返回结果都一致)

  - POST 会对服务资源做更改进而影响数据 => 即不幂等

- 状态上：
  - 浏览器不会对 POST 请求进行主动缓存，业务场景上也很少对 POST 请求做缓存

- 安全性：
  - GET 的参数放在URL，所以请求参数会以请求路径明文方式进行发送，容易被获取
- 参数：
  - POST 支持更多种类的请求参数数据类型

##### POST和PUT的区别？*

它们之间的区别主要是对于更新的定义：

- PUT 请求通常会修改数据内容，但是不会增加数据的种类 —— 更新状态
- POST 请求既可以修改数据内容，同时也可能增加数据的种类 —— 创建状态

##### OPTIONS 请求方法以及使用场景？*

OPTIONS 请求是一种HTTP请求方法，只不过它一般是由浏览器主动发送出来的一个体积小速去快的预检请求，可以获取当前服务器的状态、性能、特征等信息。

同时它还可以用来检查访问权限，比如跨域CORS

##### 了解HTTP协议的头部算法吗？如何降低开销的？**

它使用了 HPACK 算法：

- 客户端和服务端共同维护建立字典，引用索引来标识重复的字符串
- 通过编码算法压缩字符串，从而进一步减小头的大小

客户端、服务端利用字典来跟踪和实时存储之前发送的数据值，实时记忆，对于相同的数据，不再通过每次请求和响应重复发送

##### 字典的生命周期是如何的呢？是如何保证被更新的呢？**

首部表HTTP连接期内，始终保证存在并独立的，由客户端和服务端共同演进更新

每次新增的首部键值对都会被追加到末尾，更新的值会替换原有值的位置

#### 请求头和响应头

##### 了解的请求头和响应头分别有哪些？常见的Content-Type有哪些？*

请求头——浏览器告知服务端，自己的能力和配置：

- Accept：表示浏览器的能力
- Connection：表示连接类型
- Cookie：页面设置的内容
- Host：页面所在的域
- Referer：表示当前页面的运行身份
- User-Agent：判断执行环境

响应头——服务端回复告知自己能力

- Date：消息发送的时间
- Server：当前服务器
- Connection：连接类型
- Cache-Control：用于做缓存
- Content-Type：服务器返回的类型

Content-Type属性值：

- `application/x-www-form-urlencoded`：原生form表单的形式
- `multipart/form-data`：一般表单form提交POST请求
- `application/json`：序列化后的JSON字符串

#### HTTP状态码

##### 简述一下了解的状态码有哪些？*

- 1xx 信息类：接收请求并且正在处理
- 2xx 成功：请求正常且处理完毕
  - 200 OK：正确处理
  - 204 No Content：返回为空，但是正确处理了
  - 206：客户端进行了范围请求
- 3xx 重定向：需要进行附加操作完成当前请求
  - 301 永久重定向：代表域名换了、资源地址换了
  - 302 临时重定向：代表当前请求的资源地址临时被换一下，不代表永久
  - 303 请求的资源另有一个合适的途径
  - 304 浏览器缓存相关：未满足服务端查询需求、但是走缓存条件
- 4xx 客户端错误：服务端无法根据当前的请求参数处理
  - 400 请求报文出现了语法错误
  - 401 认证失败
  - 403 明确拒绝，即客户端的认证非法或者无权限
  - 404 服务端找不到对应的资源，或当服务端拒绝查询资源且不想说明理由时也会404
  - 405 当前的请求方式不被允许
- 5xx 服务端处理请求错误
  - 500 执行请求发生错误
  - 501 服务端暂时不支持当前操作
  - 503 服务端停机维护或超负荷

##### 302 303 307 三种重定向的区别有了解吗？*

302 是 http1.0 中出现的重定向，http/1.1 又细化派生了 303 和 307

- 303 比如将当前的POST请求变为GET请求进行重定向
- 307 当前的重定向会严格按照浏览器的诉求，不会将POST变成GET

#### HTTP版本能力

##### HTTP1.0 和 1.1之间有哪些区别？*

- 连接上：
  - HTTP1.1 相比于1.0 增加了持久性连接，复用同一个TCP连接上，减少多次握手和挥手

- 资源处理上：
  - 1.1 可以不用整体的资源查询，通过range来做部分查询
- 缓存上：
  - 1.0 通过`modified-xx` `expires`判断是否命中缓存
  - 1.1 通过`etag` `if-match` 缓存策略主动化，不一定通过时间

##### HTTP1.1 和 HTTP2.0 的区别？*

- 二进制协议：
  - 1.1 中头信息是文本，数据体是文本或者二进制
  - 2.0 中头信息和数据体都为二进制，信息流统称为帧

- 多路复用：
  - 2.0 中一方面复用TCP连接，同时在连接中可以同时发送多个请求或者回应
- 数据流：
  - 2.0 引入了数据流的概念，并且以数据流ID进行索引，这样请求就无需按顺序了
- 头信息压缩：
  - 对头信息进行字典化索引以及压缩
- 服务端推送：
  - 2.0 允许服务端主动向客户端未经请求地推送资源——资源而非动态数据

#### keep-alive

##### 了解什么是keep-alive？建立过程是什么样的？使用场景？优缺点？*

- 1.0 默认短连接的形式，需要主动在connection中打开keep-alive
- 1.1 默认长连接的形式，需要主动关闭

建立过程：

- 客户端发送报文夹带了keep-alive的头配置
- 服务端接受并处理，然后返回keep-alive的返回头表示可以建立长连接
- 客户端维持当前长连接建立

服务端主动断开：

- 等客户端请求之后，服务端返回后并且不带keep-alive
- 客户端接受结果后发现不带keep-alive，关闭了连接

客户端主动断开：

- 客户端请求头带上close字段
- 服务端接受后处理并断开连接
- 客户端接受资源并关闭连接

好处：

- 服务端的CPU和内存占用下降
- 请求和回复复用管道变少，降低拥塞
- 减少了后续请求的延时
- 无需每次异常都关闭TCP

缺点：

- 长时间的连接可能会导致无效的占用

#### https 和 websocket

##### 了解https吗？和http比起来有哪些区别？*

HTTPS经由HTTP进行通信，利用了SSL/TLS来加密数据包，实现了数据交换的可行性和安全性

HTTP采用明文传输，存在安全性问题，HTTPS使用了SSL/TLS，它利用了身份验证 + 信息加密 + 完整性校验。

它结合了HTTP的传输能力：

- 对发起的http请求数据进行了加密操作
- 对接受的http内容进行解密操作

##### SSL/TLS是什么？作用和工作原理？*

它是一层安全协议，主要依赖三类的基本算法：散列函数hash、对称加密、非对称加密

- 散列函数hash：如MD5、SHA1，它单向不可逆，且输入敏感型，输出长度固定 => 因此任何对于数据的修改都会导致他值的变化 => 验证信息的完整性
- 对称加密：它特点是两者公用一种密钥，同时用其进行加解密 => 存在问题，如何保证密钥的传输安全性
- 非对称加密：它利用公钥和对应私钥的互相加解密能力进行加密 => 存在问题，中间截取问题 => 为了解决它，诞生了数字证书：可信度高的机构，如果不是信任的证书，会提示

##### websocket基础原理？使用方式特点？*

它是全双工的网络技术 => 应用层，基于TCP传输协议，可以复用http的通道，原理：

- 请求：客户端向服务端发送notify => id + event
- 推送：服务端接受后立即通知所有的已连接的客户端，id满足的客户端，才会响应当前推送的反馈

#### DNS 与网络协议

##### 了解DNS的作用和传输机制吗？**

DNS将域名解析为 ip 地址，客户端会向DNS服务器发送查询请求，顺序为根域名服务器 => 顶级域名服务器 => 权威域名服务器，在找到对应服务器后，返回对应的ip地址。

其中查询的时候，会有两种查询方式：

- 迭代查询：每次请求都会单次访问不同级别的DNS服务器
- 递归查询：只向目标服务器发送一次请求，优先自我查找，会自动向下一级服务器进行进一步查询，直到查询到后，一步一步返回

##### OSI七层模型

如图：

![image-20231002172131839](https://chen-1320883525.cos.ap-chengdu.myqcloud.com/img/image-20231002172131839.png)

- 应用层：服务于应用，如ajax、域名系统DNS、WebSocket
- 表示层：底层转换，压缩，加密，解码编码等工作
- 会话层：着重不同应用的之间连接，创建、维持、断开等会话
- 传输层：着重端（端口号）的数据交流，熟悉的TCP、UDP协议位于此
- 网络层：这层定义了IP，控制传输层和数据链路层之间的信息转发，通过IP寻址和路由
- 数据链路层：将bit流合成字节，然后合成数据帧，使用MAC地址访问介质
- 物理层：就是网线，光纤等物理介质，获取传送信号传输bit流

#### TCP 和 UDP

##### 对比有何区别？*

握手机制、校验、安全保障：TCP有握手机制，UDP没有

TCP注重完整性、确定性，需要保证服务端收到，而UDP注重分发速率，不管有没有收到